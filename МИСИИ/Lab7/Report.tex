\documentclass[a4paper,14pt]{extarticle}
\usepackage{../../tex-shared/report-layout}

\renewcommand{\mylabnumber}{7}
\renewcommand{\mylabtitle}{Поиск решений CSP задач}
\renewcommand{\mysubject}{Методы и средства искусственного интеллекта}
\renewcommand{\mylecturer}{Забаштанский А.К.}

\begin{document}
\input{../../tex-shared/title-page.tex}

\section{Цель работы}
Изучение особенностей задач удовлетворения ограничений (CSP - Constraint
Satisfaction Problem) и исследование основных методов поиска их решений
средствами языка Пролог.

\section{Задание на работу}
Решить логическую задачу с обязательным использованием методов поиска решений
CSP задач на языке Пролог.

\textbf{Задача:} четыре юных филателиста: Митя, Толя, Петя и Саша — купили
почтовые марки. Каждый из них покупал марки только одной страны, причем двое из
них купили российские марки, один — болгарские и один — чешские. Известно, что
Митя и Толя купили марки двух разных стран. Марки разных стран купили Митя с
Сашей, Петя с Сашей, Петя с Митей и Толя с Сашей. Кроме того, известно, что Митя
купил не болгарские марки. Кто купил болгарские марки?

\section{Ход работы}
\subsection{Разработка программы}
Текст программы:
\begin{lstlisting}
%========предикаты обработки списков============================================

%перестановка элементов списка
%в начале находим перестановку L1 для хвоста списка L, а
%затем выполняем вставку головы списка H в произвольную позицию L1
перестановка([],[]).
перестановка([X|L],P):-перестановка(L,L1),вставить(X,L1,P).

%вставка элемента Х в список L1
%реализована через удаление X из рез. списка L2
вставить(X,L1,L2):-удалить(X,L2,L1).

%удаление элемента списка: удалить(X,L,L1), где L1- это L без X
удалить(X,[X|T],T).
удалить(X,[Н|T],[Н|T1]):-удалить(X,T,T1).

%===============вспомогательный предикат========================================
% цикл повторения выполнения Цели заданное число раз (N)
повторять(Цель,1):-Цель.
повторять(Цель,N):-
	not(not(Цель)), %стирание предыдущих подстановок
	M is N-1,повторять(Цель,M).

решить(X):- генерировать_решение(X), проверить_ограничения(X).
решить2(X):- проверить_ограничения(X), генерировать_решение(X).
генерировать_решение(Res):-
	перестановка([_/'Россия', _/'Россия', _/'Болгария', _/'Чехия'], Res).
проверить_ограничения(Res):-
       Res = ['Митя'/X1, 'Толя'/X2, 'Петя'/X3, 'Саша'/X4],   
	X1 \= X2,
	X1 \= X4,
	X3 \= X4,
	X1 \= X3,
	X2 \= X4,
	  X1 \= 'Болгария'.
\end{lstlisting}

\subsection{Проверка работы программы}
\begin{lstlisting}
|решить(В).
В = ['Митя'/'Чехия', 'Толя'/'Россия', 'Петя'/'Россия', 'Саша'/'Болгария']

:-time(повторять(решить(В), 10000)).
% 1,229,997 inferences, 0.156 CPU in 0.161 seconds (97% CPU, 7871981 Lips)
В = ['Митя'/'Чехия', 'Толя'/'Россия', 'Петя'/'Россия', 'Саша'/'Болгария']
\end{lstlisting}

\section*{Выводы}
В ходе лабораторной работы изучены особенности задач удовлетворения ограничений
(CSP - Constraint Satisfaction Problem) и исследованы основные методы поиска их
решений средствами языка Пролог. Написана программа, использующая метод
«Генерируй и тестируй», которая работает весьма быстро.

\end{document}